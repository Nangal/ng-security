/*
 ngsecurity v1.3.0
 (c) 2015 Concrete Solutions, Inc.
 License: MIT
*/
//# sourceMappingURL=ngsecurity.min.js.map
'use strict';(function(){function k(a){return{link:function(d,b,c){var f=b.css("display");d.$watch(function(){return a.isAuthenticated()},function(a){a?b.css("display",f):b.css("display","none")})},restrict:"A"}}function l(a){return{link:function(d,b,c){var f=b.css("display");d.$watch(function(){return a.isAuthenticated()},function(a){a?b.css("display","none"):b.css("display",f)})},restrict:"A"}}function m(a){return{link:function(d,b,c){var f=b.css("display"),g=c.ngPermissionType,h=c.ngIfPermission.split(",");
d.$watch(function(){return a.getPermissions()},function(){a.getPermissionValidation(g)(h)?b.css("display",f):b.css("display","none")},!0)},restrict:"A"}}function n(a,d){return{link:function(b,c,f){var g=c.css("display"),h=f.ngPermissionType,p=function(e){a.hasPermission(e)||a.getPermissionValidation(h)(e)?c.css("display",g):c.css("display","none")};b.$watch(function(){return d(f.ngIfPermissionModel)(b)},function(a){p(a)});b.$watch(function(){return a.getPermissions()},function(){var a=d(f.ngIfPermissionModel)(b);
p(a)},!0)},restrict:"A"}}function q(a){return{link:function(d,b,c){var f=c.ngPermissionType,g=c.ngEnabledPermission.split(",");d.$watch(function(){return a.getPermissions()},function(){a.getPermissionValidation(f)(g)?b.removeAttr("disabled"):b.attr("disabled","true")},!0)},restrict:"A"}}function r(a){return{link:function(d,b,c){b.bind("click",a.logout)},restrict:"A"}}function t(a){return{link:function(d,b,c){d.$watch(function(){return a.getUser()},function(a){b.text(a[c.ngBindUser])},!0)},restrict:"A"}}
function u(a,d){return{link:function(b,c,f,d){c.bind("submit",function(){var b=f.ngSubmitLogin,d=c.find("input"),e={};angular.forEach(d,function(a){"submit"!==a.type&&a.name&&(e[a.name]=a.value)});a.loginByUrl(b,e)})},restrict:"A",require:"^form"}}function v(a,d,b,c){var f={login:function(){return g[c.strategy].apply(this,arguments)},loginByUrl:function(a,c){return d(function(e,d){b.post(a,c).success(function(a){f.login(a.token,a.user,a.permissions);e(a)}).error(d)})},logout:function(){a.remove(c.storageName.token);
a.remove(c.storageName.user);a.remove(c.storageName.permissions)},hasPermission:function(b){var d=a.getObject(c.storageName.permissions);return d?-1!==d.indexOf(b):!1},hasAllPermission:function(b){var d=a.getObject(c.storageName.permissions),e=!0;b&&d?angular.forEach(b,function(a){-1===d.indexOf(a)&&(e=!1)}):e=!1;return e},hasAnyPermission:function(b){var d=a.getObject(c.storageName.permissions),e=!1;b&&d&&angular.forEach(b,function(a){-1!==d.indexOf(a)&&(e=!0)});return e},getPermissionValidation:function(a){var c=
{ANY:f.hasAnyPermission,ALL:f.hasAllPermission};a||(a="ANY");return c[a]},isAuthenticated:function(){return!!a.get(c.storageName.token)},getUser:function(){return a.getObject(c.storageName.user)},getPermissions:function(){return a.getObject(c.storageName.permissions)}},g={jwt:function(b,d){var e;e=b.split(".")[1];if(2===e.length%4)e+="==";else if(3===e.length%4)e+="=";else if(0!==e.length%4)throw"Invalid token string.";e=JSON.parse(atob(e+"=="));a.put(c.storageName.token,c.token.prefix+b);a.putObject(c.storageName.user,
e);a.putObject(c.storageName.permissions,d)},simple:function(b,d,e){a.put(c.storageName.token,c.token.prefix+b);a.putObject(c.storageName.user,d);a.putObject(c.storageName.permissions,e)}};return f}function w(a,d,b,c){return{request:function(a){a.headers[c.token.header]=b.get(c.storageName.token);return a},responseError:function(b){var g=c.responseErrorName;g[b.status]&&a.$broadcast(g[b.status],b);return d.reject(b)}}}angular.module("ngSecurity",["ngCookies"]);angular.module("ngSecurity").directive("ngIfAuthenticated",
k).directive("ngIfAnonymous",l).directive("ngIfPermission",m).directive("ngIfPermissionModel",n).directive("ngEnabledPermission",q).directive("ngClickLogout",r).directive("ngBindUser",t).directive("ngSubmitLogin",u);k.$inject=["$security"];l.$inject=["$security"];m.$inject=["$security"];n.$inject=["$security","$parse"];q.$inject=["$security"];r.$inject=["$security"];t.$inject=["$security"];u.$inject=["$security","$parse"];angular.module("ngSecurity").provider("$securityConfig",function(){var a={},
d={strategy:"simple",token:{header:"Authorization",prefix:""},storageName:{token:"ng-security-authorization",user:"ng-security-user",permissions:"ng-security-permissions"},responseErrorName:{401:"unauthenticated",403:"permissionDenied"}};a.$get=function(){return d};a.configure=function(a){d=angular.merge(d,a)};return a});angular.module("ngSecurity").factory("$security",v).factory("$securityInterceptor",w);v.$inject=["$cookies","$q","$http","$securityConfig"];w.$inject=["$rootScope","$q","$cookies",
"$securityConfig"]}).call(window);
