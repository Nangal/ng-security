/*
 ngsecurity v1.5.0
 (c) 2015 Concrete Solutions, Inc.
 License: MIT
*/
//# sourceMappingURL=ngsecurity.min.js.map
'use strict';(function(){function l(a,d){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(b,c,f,g,h){var k=new m(b,c,f,g,h,d);b.$watch(function(){return a.isAuthenticated()},function(a){k.handle(a)})}}}function n(a,d){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(b,c,f,g,h){var k=new m(b,c,f,g,h,d);b.$watch(function(){return a.isAuthenticated()},function(a){k.handle(!a)})}}}function p(a){return{link:function(d,
b,c){var f=b.css("display"),g=c.ngPermissionType,h=c.ngIfPermission.split(",");d.$watch(function(){return a.getPermissions()},function(){a.getPermissionValidation(g)(h)?b.css("display",f):b.css("display","none")},!0)},restrict:"A"}}function q(a,d){return{link:function(b,c,f){var g=c.css("display"),h=f.ngPermissionType,k=function(b){a.hasPermission(b)||a.getPermissionValidation(h)(b)?c.css("display",g):c.css("display","none")};b.$watch(function(){return d(f.ngIfPermissionModel)(b)},function(a){k(a)});
b.$watch(function(){return a.getPermissions()},function(){var a=d(f.ngIfPermissionModel)(b);k(a)},!0)},restrict:"A"}}function r(a){return{link:function(d,b,c){var f=c.ngPermissionType,g=c.ngEnabledPermission.split(",");d.$watch(function(){return a.getPermissions()},function(){a.getPermissionValidation(f)(g)?b.removeAttr("disabled"):b.attr("disabled","true")},!0)},restrict:"A"}}function t(a){return{link:function(d,b,c){b.bind("click",a.logout)},restrict:"A"}}function u(a){return{link:function(d,b,
c){d.$watch(function(){return a.getUser()},function(a){b.text(a[c.ngBindUser])},!0)},restrict:"A"}}function v(a,d){return{link:function(b,c,f,g){c.bind("submit",function(){var h=f.ngSubmitLogin,k=c.find("input"),e={};angular.forEach(k,function(a){"submit"!==a.type&&a.name&&(e[a.name]=a.value)});d.loginByUrl(h,e).then(function(c){a.$broadcast("ng-security:login:success");b.ngLoginSuccess({$response:c})}).catch(function(c){a.$broadcast("ng-security:login:error");b.ngLoginError({$response:c})})})},restrict:"A",
scope:{ngLoginSuccess:"&",ngLoginError:"&"},require:"^form"}}function w(a){return{link:function(d,b,c,f){var g=b.css("display");b.css("display","none");a.$on("ng-security:login:success",function(){b.css("display",g)});a.$on("ng-security:login:error",function(){b.css("display","none")})},restrict:"AEC"}}function x(a){return{link:function(d,b,c,f){var g=b.css("display");b.css("display","none");a.$on("ng-security:login:success",function(){b.css("display","none")});a.$on("ng-security:login:error",function(){b.css("display",
g)})},restrict:"AEC"}}function m(a,d,b,c,f,g){var h,k,e;this.handle=function(a){a?k||f(function(a,c){k=c;a[a.length++]=document.createComment(" end ng-securityIf");h={clone:a};g.enter(a,d.parent(),d)}):(e&&(e.remove(),e=null),k&&(k.$destroy(),k=null),h&&(e=getBlockNodes(h.clone),g.leave(e).then(function(){e=null}),h=null))}}function y(a,d,b,c){var f={login:function(){return g[c.strategy].apply(this,arguments)},loginByUrl:function(a,c){return d(function(e,d){b.post(a,c).success(function(a){f.login(a.token,
a.user,a.permissions);e(a)}).error(d)})},logout:function(){a.remove(c.storageName.token);a.remove(c.storageName.user);a.remove(c.storageName.permissions)},hasPermission:function(b){var d=a.getObject(c.storageName.permissions);return d?-1!==d.indexOf(b):!1},hasAllPermission:function(b){var d=a.getObject(c.storageName.permissions),e=!0;b&&d?angular.forEach(b,function(a){-1===d.indexOf(a)&&(e=!1)}):e=!1;return e},hasAnyPermission:function(b){var d=a.getObject(c.storageName.permissions),e=!1;b&&d&&angular.forEach(b,
function(a){-1!==d.indexOf(a)&&(e=!0)});return e},getPermissionValidation:function(a){var c={ANY:f.hasAnyPermission,ALL:f.hasAllPermission};a||(a="ANY");return c[a]},isAuthenticated:function(){return!!a.get(c.storageName.token)},getUser:function(){return a.getObject(c.storageName.user)},getPermissions:function(){return a.getObject(c.storageName.permissions)}},g={jwt:function(b,d){var e;e=b.split(".")[1];if(2===e.length%4)e+="==";else if(3===e.length%4)e+="=";else if(0!==e.length%4)throw"Invalid token string.";
e=JSON.parse(atob(e+"=="));a.put(c.storageName.token,c.token.prefix+b);a.putObject(c.storageName.user,e);a.putObject(c.storageName.permissions,d)},simple:function(b,d,e){a.put(c.storageName.token,c.token.prefix+b);a.putObject(c.storageName.user,d);a.putObject(c.storageName.permissions,e)}};return f}function z(a,d,b,c){return{request:function(a){a.headers[c.token.header]=b.get(c.storageName.token);return a},responseError:function(b){var g=c.responseErrorName;g[b.status]&&a.$broadcast(g[b.status],b);
return d.reject(b)}}}angular.module("ngSecurity",["ngCookies"]);angular.module("ngSecurity").directive("ngIfAuthenticated",l).directive("ngIfAnonymous",n).directive("ngIfPermission",p).directive("ngIfPermissionModel",q).directive("ngEnabledPermission",r).directive("ngClickLogout",t).directive("ngBindUser",u).directive("ngSubmitLogin",v).directive("ngShowLoginSuccess",w).directive("ngShowLoginError",x);l.$inject=["$security","$animate"];n.$inject=["$security","$animate"];p.$inject=["$security"];q.$inject=
["$security","$parse"];r.$inject=["$security"];t.$inject=["$security"];u.$inject=["$security"];v.$inject=["$rootScope","$security"];w.$inject=["$rootScope"];x.$inject=["$rootScope"];angular.module("ngSecurity").provider("$securityConfig",function(){var a={},d={strategy:"simple",token:{header:"Authorization",prefix:""},storageName:{token:"ng-security-authorization",user:"ng-security-user",permissions:"ng-security-permissions"},responseErrorName:{401:"unauthenticated",403:"permissionDenied"}};a.$get=
function(){return d};a.configure=function(a){d=angular.merge(d,a)};return a});angular.module("ngSecurity").factory("$security",y).factory("$securityInterceptor",z);y.$inject=["$cookies","$q","$http","$securityConfig"];z.$inject=["$rootScope","$q","$cookies","$securityConfig"]}).call(window);
