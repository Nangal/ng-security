/*
 ngsecurity v1.4.0
 (c) 2015 Concrete Solutions, Inc.
 License: MIT
*/
//# sourceMappingURL=ngsecurity.min.js.map
'use strict';(function(){function k(a){return{link:function(c,b,d){var e=b.css("display");c.$watch(function(){return a.isAuthenticated()},function(a){a?b.css("display",e):b.css("display","none")})},restrict:"A"}}function l(a){return{link:function(c,b,d){var e=b.css("display");c.$watch(function(){return a.isAuthenticated()},function(a){a?b.css("display","none"):b.css("display",e)})},restrict:"A"}}function m(a){return{link:function(c,b,d){var e=b.css("display"),f=d.ngPermissionType,g=d.ngIfPermission.split(",");
c.$watch(function(){return a.getPermissions()},function(){a.getPermissionValidation(f)(g)?b.css("display",e):b.css("display","none")},!0)},restrict:"A"}}function n(a,c){return{link:function(b,d,e){var f=d.css("display"),g=e.ngPermissionType,h=function(b){a.hasPermission(b)||a.getPermissionValidation(g)(b)?d.css("display",f):d.css("display","none")};b.$watch(function(){return c(e.ngIfPermissionModel)(b)},function(a){h(a)});b.$watch(function(){return a.getPermissions()},function(){var a=c(e.ngIfPermissionModel)(b);
h(a)},!0)},restrict:"A"}}function q(a){return{link:function(c,b,d){var e=d.ngPermissionType,f=d.ngEnabledPermission.split(",");c.$watch(function(){return a.getPermissions()},function(){a.getPermissionValidation(e)(f)?b.removeAttr("disabled"):b.attr("disabled","true")},!0)},restrict:"A"}}function r(a){return{link:function(c,b,d){b.bind("click",a.logout)},restrict:"A"}}function t(a){return{link:function(c,b,d){c.$watch(function(){return a.getUser()},function(a){b.text(a[d.ngBindUser])},!0)},restrict:"A"}}
function u(a,c){return{link:function(b,d,e,f){d.bind("submit",function(){var g=e.ngSubmitLogin,h=d.find("input"),p={};angular.forEach(h,function(a){"submit"!==a.type&&a.name&&(p[a.name]=a.value)});c.loginByUrl(g,p).then(function(d){a.$broadcast("ng-security:login:success");b.ngLoginSuccess({$response:d})}).catch(function(d){a.$broadcast("ng-security:login:error");b.ngLoginError({$response:d})})})},restrict:"A",scope:{ngLoginSuccess:"&",ngLoginError:"&"},require:"^form"}}function v(a){return{link:function(c,
b,d,e){var f=b.css("display");b.css("display","none");a.$on("ng-security:login:success",function(){b.css("display",f)});a.$on("ng-security:login:error",function(){b.css("display","none")})},restrict:"AEC"}}function w(a){return{link:function(c,b,d,e){var f=b.css("display");b.css("display","none");a.$on("ng-security:login:success",function(){b.css("display","none")});a.$on("ng-security:login:error",function(){b.css("display",f)})},restrict:"AEC"}}function x(a,c,b,d){var e={login:function(){return f[d.strategy].apply(this,
arguments)},loginByUrl:function(a,d){return c(function(c,f){b.post(a,d).success(function(a){e.login(a.token,a.user,a.permissions);c(a)}).error(f)})},logout:function(){a.remove(d.storageName.token);a.remove(d.storageName.user);a.remove(d.storageName.permissions)},hasPermission:function(b){var e=a.getObject(d.storageName.permissions);return e?-1!==e.indexOf(b):!1},hasAllPermission:function(b){var e=a.getObject(d.storageName.permissions),c=!0;b&&e?angular.forEach(b,function(a){-1===e.indexOf(a)&&(c=
!1)}):c=!1;return c},hasAnyPermission:function(b){var e=a.getObject(d.storageName.permissions),c=!1;b&&e&&angular.forEach(b,function(a){-1!==e.indexOf(a)&&(c=!0)});return c},getPermissionValidation:function(a){var b={ANY:e.hasAnyPermission,ALL:e.hasAllPermission};a||(a="ANY");return b[a]},isAuthenticated:function(){return!!a.get(d.storageName.token)},getUser:function(){return a.getObject(d.storageName.user)},getPermissions:function(){return a.getObject(d.storageName.permissions)}},f={jwt:function(b,
e){var c;c=b.split(".")[1];if(2===c.length%4)c+="==";else if(3===c.length%4)c+="=";else if(0!==c.length%4)throw"Invalid token string.";c=JSON.parse(atob(c+"=="));a.put(d.storageName.token,d.token.prefix+b);a.putObject(d.storageName.user,c);a.putObject(d.storageName.permissions,e)},simple:function(b,c,e){a.put(d.storageName.token,d.token.prefix+b);a.putObject(d.storageName.user,c);a.putObject(d.storageName.permissions,e)}};return e}function y(a,c,b,d){return{request:function(a){a.headers[d.token.header]=
b.get(d.storageName.token);return a},responseError:function(b){var f=d.responseErrorName;f[b.status]&&a.$broadcast(f[b.status],b);return c.reject(b)}}}angular.module("ngSecurity",["ngCookies"]);angular.module("ngSecurity").directive("ngIfAuthenticated",k).directive("ngIfAnonymous",l).directive("ngIfPermission",m).directive("ngIfPermissionModel",n).directive("ngEnabledPermission",q).directive("ngClickLogout",r).directive("ngBindUser",t).directive("ngSubmitLogin",u).directive("ngShowLoginSuccess",v).directive("ngShowLoginError",
w);k.$inject=["$security"];l.$inject=["$security"];m.$inject=["$security"];n.$inject=["$security","$parse"];q.$inject=["$security"];r.$inject=["$security"];t.$inject=["$security"];u.$inject=["$rootScope","$security"];v.$inject=["$rootScope"];w.$inject=["$rootScope"];angular.module("ngSecurity").provider("$securityConfig",function(){var a={},c={strategy:"simple",token:{header:"Authorization",prefix:""},storageName:{token:"ng-security-authorization",user:"ng-security-user",permissions:"ng-security-permissions"},
responseErrorName:{401:"unauthenticated",403:"permissionDenied"}};a.$get=function(){return c};a.configure=function(a){c=angular.merge(c,a)};return a});angular.module("ngSecurity").factory("$security",x).factory("$securityInterceptor",y);x.$inject=["$cookies","$q","$http","$securityConfig"];y.$inject=["$rootScope","$q","$cookies","$securityConfig"]}).call(window);
