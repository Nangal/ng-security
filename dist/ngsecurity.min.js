/*
 ngsecurity v1.5.1
 (c) 2015 Concrete Solutions, Inc.
 License: MIT
*/
//# sourceMappingURL=ngsecurity.min.js.map
'use strict';(function(){function m(c,d,b){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(f,a,e,k,g){var h=new n(f,a,e,k,g,d);b.$on("authChanged",function(a,d){h.handle(d)});console.log("registered ano");h.handle(c.isAuthenticated())}}}function p(c,d,b){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(f,a,e,k,g){var h=new n(f,a,e,k,g,d);b.$on("authChanged",function(a,d){h.handle(!d)});
console.log("registered ano");h.handle(!c.isAuthenticated())}}}function q(c){return{link:function(d,b,f){var a=b.css("display"),e=f.ngPermissionType,k=f.ngIfPermission.split(",");d.$watch(function(){return c.getPermissions()},function(){c.getPermissionValidation(e)(k)?b.css("display",a):b.css("display","none")},!0)},restrict:"A"}}function r(c,d){return{link:function(b,f,a){var e=f.css("display"),k=a.ngPermissionType,g=function(a){c.hasPermission(a)||c.getPermissionValidation(k)(a)?f.css("display",
e):f.css("display","none")};b.$watch(function(){return d(a.ngIfPermissionModel)(b)},function(a){g(a)});b.$watch(function(){return c.getPermissions()},function(){var c=d(a.ngIfPermissionModel)(b);g(c)},!0)},restrict:"A"}}function t(c){return{link:function(d,b,f){var a=f.ngPermissionType,e=f.ngEnabledPermission.split(",");d.$watch(function(){return c.getPermissions()},function(){c.getPermissionValidation(a)(e)?b.removeAttr("disabled"):b.attr("disabled","true")},!0)},restrict:"A"}}function u(c){return{link:function(d,
b,f){b.bind("click",c.logout)},restrict:"A"}}function v(c){return{link:function(d,b,f){d.$watch(function(){return c.getUser()},function(a){b.text(a[f.ngBindUser])},!0)},restrict:"A"}}function w(c,d){return{link:function(b,f,a,e){f.bind("submit",function(){var e=a.ngSubmitLogin,g=f.find("input"),h={};angular.forEach(g,function(a){"submit"!==a.type&&a.name&&(h[a.name]=a.value)});d.loginByUrl(e,h).then(function(a){c.$broadcast("ng-security:login:success");b.ngLoginSuccess({$response:a})}).catch(function(a){c.$broadcast("ng-security:login:error");
b.ngLoginError({$response:a})})})},restrict:"A",scope:{ngLoginSuccess:"&",ngLoginError:"&"},require:"^form"}}function x(c){return{link:function(d,b,f,a){var e=b.css("display");b.css("display","none");c.$on("ng-security:login:success",function(){b.css("display",e)});c.$on("ng-security:login:error",function(){b.css("display","none")})},restrict:"AEC"}}function y(c){return{link:function(d,b,f,a){var e=b.css("display");b.css("display","none");c.$on("ng-security:login:success",function(){b.css("display",
"none")});c.$on("ng-security:login:error",function(){b.css("display",e)})},restrict:"AEC"}}function n(c,d,b,f,a,e){function k(a){for(var d=a[0],c=a[a.length-1],b,g=1;d!==c&&(d=d.nextSibling);g++)if(b||a[g]!==d)b||(b=jqLite(slice.call(a,0,g))),b.push(d);return b||a}var g,h,l;this.handle=function(b){b?h||a(function(a,b){h=b;a[a.length++]=document.createComment(" end ng-securityIf");g={clone:a};e.enter(a,d.parent(),d)}):(l&&(l.remove(),l=null),h&&(h.$destroy(),h=null),g&&(l=k(g.clone),e.leave(l).then(function(){l=
null}),g=null))}}function z(c,d,b,f,a){var e={login:function(){k[a.strategy].apply(this,arguments);return c.$emit("authChanged",e.isAuthenticated())},loginByUrl:function(a,d){return b(function(b,k){f.post(a,d).success(function(a){e.login(a.token,a.user,a.permissions);c.$emit("authChanged",e.isAuthenticated());b(a)}).error(k)})},logout:function(){d.remove(a.storageName.token);d.remove(a.storageName.user);d.remove(a.storageName.permissions);c.$emit("authChanged",e.isAuthenticated())},hasPermission:function(b){var c=
d.getObject(a.storageName.permissions);return c?-1!==c.indexOf(b):!1},hasAllPermission:function(b){var c=d.getObject(a.storageName.permissions),e=!0;b&&c?angular.forEach(b,function(a){-1===c.indexOf(a)&&(e=!1)}):e=!1;return e},hasAnyPermission:function(b){var c=d.getObject(a.storageName.permissions),e=!1;b&&c&&angular.forEach(b,function(a){-1!==c.indexOf(a)&&(e=!0)});return e},getPermissionValidation:function(a){var b={ANY:e.hasAnyPermission,ALL:e.hasAllPermission};a||(a="ANY");return b[a]},isAuthenticated:function(){return!!d.get(a.storageName.token)},
getUser:function(){return d.getObject(a.storageName.user)},getPermissions:function(){return d.getObject(a.storageName.permissions)}},k={jwt:function(b,c){var e;e=b.split(".")[1];if(2===e.length%4)e+="==";else if(3===e.length%4)e+="=";else if(0!==e.length%4)throw"Invalid token string.";e=JSON.parse(atob(e+"=="));d.put(a.storageName.token,a.token.prefix+b);d.putObject(a.storageName.user,e);d.putObject(a.storageName.permissions,c)},simple:function(b,c,e){d.put(a.storageName.token,a.token.prefix+b);d.putObject(a.storageName.user,
c);d.putObject(a.storageName.permissions,e)}};return e}function A(c,d,b,f){return{request:function(a){a.headers[f.token.header]=b.get(f.storageName.token);return a},responseError:function(a){var b=f.responseErrorName;b[a.status]&&c.$broadcast(b[a.status],a);return d.reject(a)}}}angular.module("ngSecurity",["ngCookies"]);angular.module("ngSecurity").directive("ngIfAuthenticated",m).directive("ngIfAnonymous",p).directive("ngIfPermission",q).directive("ngIfPermissionModel",r).directive("ngEnabledPermission",
t).directive("ngClickLogout",u).directive("ngBindUser",v).directive("ngSubmitLogin",w).directive("ngShowLoginSuccess",x).directive("ngShowLoginError",y);m.$inject=["$security","$animate","$rootScope"];p.$inject=["$security","$animate","$rootScope"];q.$inject=["$security"];r.$inject=["$security","$parse"];t.$inject=["$security"];u.$inject=["$security"];v.$inject=["$security"];w.$inject=["$rootScope","$security"];x.$inject=["$rootScope"];y.$inject=["$rootScope"];angular.module("ngSecurity").provider("$securityConfig",
function(){var c={},d={strategy:"simple",token:{header:"Authorization",prefix:""},storageName:{token:"ng-security-authorization",user:"ng-security-user",permissions:"ng-security-permissions"},responseErrorName:{401:"unauthenticated",403:"permissionDenied"}};c.$get=function(){return d};c.configure=function(b){d=angular.merge(d,b)};return c});angular.module("ngSecurity").factory("$security",z).factory("$securityInterceptor",A);z.$inject=["$rootScope","$cookies","$q","$http","$securityConfig"];A.$inject=
["$rootScope","$q","$cookies","$securityConfig"]}).call(window);
